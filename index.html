<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>בראשית פרק י' - האזנה לקריאה</title>
    <style>
        body {
            font-family: 'SBL Hebrew', 'Ezra SIL', 'David', serif;
            background-color: #fcf6e5; /* צבע קלף עדין */
            color: #333;
            max-width: 800px;
            margin: 20px auto;
            padding: 20px;
            line-height: 1.6;
        }

        h1 {
            text-align: center;
            font-family: sans-serif;
        }

        .pasuk {
            font-size: 24px;
            margin-bottom: 12px;
            padding: 5px 10px;
            cursor: pointer;
            border-radius: 5px;
            transition: background-color 0.2s;
        }

        .pasuk:hover {
            background-color: #eaddcf;
        }

        .pasuk.playing {
            background-color: #d4e6f1;
            border-right: 4px solid #2980b9;
        }

        .num {
            color: #8b0000;
            font-weight: bold;
            margin-left: 8px;
            font-size: 0.9em;
        }

        /* מרווח בין פסוקים או פרשיות */
        .samekh {
            display: inline-block;
            margin: 0 10px;
            font-size: 0.8em;
        }
    </style>
</head>
<body>

    <h1>בראשית פרק י' (פסוקים טו-לב)</h1>
    <p style="text-align:center; color: #666; font-family:sans-serif;">לחץ על פסוק כדי להאזין</p>

    <div id="torah-text">
        <div class="pasuk" id="p15" onclick="playSingle(15)"><span class="num">טו</span> וּכְנַ֗עַן יָלַ֛ד אֶת־צִידֹ֥ן בְּכֹר֖וֹ וְאֶת־חֵֽת׃</div>
        <div class="pasuk" id="p16" onclick="playSingle(16)"><span class="num">טז</span> וְאֶת־הַיְבוּסִי֙ וְאֶת־הָ֣אֱמֹרִ֔י וְאֵ֖ת הַגִּרְגָּשִֽׁי׃</div>
        <div class="pasuk" id="p17" onclick="playSingle(17)"><span class="num">יז</span> וְאֶת־הַֽחִוִּ֥י וְאֶת־הַֽעַרְקִ֖י וְאֶת־הַסִּינִֽי׃</div>
        <div class="pasuk" id="p18" onclick="playSingle(18)"><span class="num">יח</span> וְאֶת־הָֽאַרְוָדִ֥י וְאֶת־הַצְּמָרִ֖י וְאֶת־הַֽחֲמָתִ֑י וְאַחַ֣ר נָפֹ֔צוּ מִשְׁפְּח֖וֹת הַֽכְּנַעֲנִֽי׃</div>
        <div class="pasuk" id="p19" onclick="playSingle(19)"><span class="num">יט</span> וַיְהִ֞י גְּב֤וּל הַֽכְּנַעֲנִי֙ מִצִּידֹ֔ן בֹּֽאֲכָ֥ה גְרָ֖רָה עַד־עַזָּ֑ה בֹּֽאֲכָ֞ה סְדֹ֧מָה וַֽעֲמֹרָ֛ה וְאַדְמָ֥ה וּצְבֹיִ֖ם עַד־לָֽשַׁע׃</div>
        <div class="pasuk" id="p20" onclick="playSingle(20)"><span class="num">כ</span> אֵ֣לֶּה בְנֵי־חָ֔ם לְמִשְׁפְּחֹתָ֖ם לִלְשֹֽׁנֹתָ֑ם בְּאַרְצֹתָ֖ם בְּגֽוֹיֵהֶֽם׃ {ס}</div>
        <div class="pasuk" id="p21" onclick="playSingle(21)"><span class="num">כא</span> וּלְשֵׁ֥ם יֻלַּ֖ד גַּם־ה֑וּא אֲבִי֙ כָּל־בְּנֵי־עֵ֔בֶר אֲחִ֖י יֶ֥פֶת הַגָּדֽוֹל׃</div>
        <div class="pasuk" id="p22" onclick="playSingle(22)"><span class="num">כב</span> בְּנֵ֥י שֵׁ֖ם עֵילָ֣ם וְאַשּׁ֑וּר וְאַרְפַּכְשַׁ֖ד וְל֥וּד וַֽאֲרָֽם׃</div>
        <div class="pasuk" id="p23" onclick="playSingle(23)"><span class="num">כג</span> וּבְנֵ֖י אֲרָ֑ם ע֥וּץ וְח֖וּל וְגֶ֥תֶר וָמַֽשׁ׃</div>
        <div class="pasuk" id="p24" onclick="playSingle(24)"><span class="num">כד</span> וְאַרְפַּכְשַׁ֖ד יָלַ֣ד אֶת־שָׁ֑לַח וְשֶׁ֖לַח יָלַ֥ד אֶת־עֵֽבֶר׃</div>
        <div class="pasuk" id="p25" onclick="playSingle(25)"><span class="num">כה</span> וּלְעֵ֥בֶר יֻלַּ֖ד שְׁנֵ֣י בָנִ֑ים שֵׁ֣ם הָֽאֶחָ֞ד פֶּ֗לֶג כִּ֤י בְיָמָיו֙ נִפְלְגָ֣ה הָאָ֔רֶץ וְשֵׁ֥ם אָחִ֖יו יָקְטָֽן׃</div>
        <div class="pasuk" id="p26" onclick="playSingle(26)"><span class="num">כו</span> וְיָקְטָ֣ן יָלַ֔ד אֶת־אַלְמוֹדָ֖ד וְאֶת־שָׁ֑לֶף וְאֶת־חֲצַרְמָ֖וֶת וְאֶת־יָֽרַח׃</div>
        <div class="pasuk" id="p27" onclick="playSingle(27)"><span class="num">כז</span> וְאֶת־הֲדוֹרָ֥ם וְאֶת־אוּזָ֖ל וְאֶת־דִּקְלָֽה׃</div>
        <div class="pasuk" id="p28" onclick="playSingle(28)"><span class="num">כח</span> וְאֶת־עוֹבָ֥ל וְאֶת־אֲבִֽימָאֵ֖ל וְאֶת־שְׁבָֽא׃</div>
        <div class="pasuk" id="p29" onclick="playSingle(29)"><span class="num">כט</span> וְאֶת־אוֹפִ֥ר וְאֶת־חֲוִילָ֖ה וְאֶת־יוֹבָ֑ב כָּל־אֵ֖לֶּה בְּנֵ֥י יָקְטָֽן׃</div>
        <div class="pasuk" id="p30" onclick="playSingle(30)"><span class="num">ל</span> וַיְהִ֥י מֽוֹשָׁבָ֖ם מִמֵּשָׁ֑א בֹּֽאֲכָ֥ה סְפָ֖רָה הַ֥ר הַקֶּֽדֶם׃</div>
        <div class="pasuk" id="p31" onclick="playSingle(31)"><span class="num">לא</span> אֵ֣לֶּה בְנֵי־שֵׁ֔ם לְמִשְׁפְּחֹתָ֖ם לִלְשֹֽׁנֹתָ֑ם בְּאַרְצֹתָ֖ם לְגֽוֹיֵהֶֽם׃</div>
        <div class="pasuk" id="p32" onclick="playSingle(32)"><span class="num">לב</span> אֵ֣לֶּה מִשְׁפְּחֹ֧ת בְּנֵי־נֹ֛חַ לְתֽוֹלְדֹתָ֖ם בְּגֽוֹיֵהֶ֑ם וּמֵאֵ֜לֶּה נִפְרְד֧וּ הַגּוֹיִ֛ם בָּאָ֖רֶץ אַחַ֥ר הַמַּבּֽוּל׃</div>

        </div>

    <script>
        // מספר הפרק (מותאם לטקסט שסופק - בראשית י')
        const currentChapter = 10;
        let currentAudio = null;

        // טעינה מוקדמת חכמה (Preload)
        document.addEventListener('DOMContentLoaded', () => {
            console.log('Starting preload...');
            const allPasukDivs = document.querySelectorAll('.pasuk');
            
            allPasukDivs.forEach(div => {
                // חילוץ ה-ID האמיתי של הפסוק (מוריד את ה-p)
                const verseId = div.id.replace('p', '');
                const fileName = `${currentChapter}_${verseId}.m4a`;
                
                // יצירת אובייקט אודיו לטעינה ברקע
                const audioObj = new Audio();
                audioObj.src = fileName;
                audioObj.preload = 'auto'; // מבקש מהדפדפן לטעון את הקובץ
                
                // לוג לבדיקה (אופציונלי)
                // console.log(`Preloading: ${fileName}`);
            });
        });

        // פונקציית ניגון
        function playSingle(verseNum) {
            // עצירת ניגון קודם אם יש
            if (currentAudio) {
                currentAudio.pause();
                currentAudio.currentTime = 0;
            }

            // הסרת סימון ויזואלי מכל הפסוקים
            document.querySelectorAll('.pasuk').forEach(p => p.classList.remove('playing'));

            // הגדרת שם הקובץ: פרק_פסוק.m4a
            const fileName = `${currentChapter}_${verseNum}.m4a`;
            currentAudio = new Audio(fileName);
            
            // הוספת סימון ויזואלי לפסוק הנוכחי
            const currentDiv = document.getElementById('p' + verseNum);
            if(currentDiv) {
                currentDiv.classList.add('playing');
            }

            // טיפול בסיום הניגון (הסרת הסימון)
            currentAudio.onended = function() {
                if(currentDiv) currentDiv.classList.remove('playing');
            };

            // טיפול בשגיאות (אם הקובץ לא קיים)
            currentAudio.onerror = function() {
                console.error(`Audio file missing: ${fileName}`);
                alert(`קובץ השמע לא נמצא: ${fileName}`);
                if(currentDiv) currentDiv.classList.remove('playing');
            };

            currentAudio.play();
        }
    </script>
</body>
</html>
